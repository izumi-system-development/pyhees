# -*- coding: utf-8 -*-
"""CRAC_calc_200713_mitaka.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1ileEB380P31sZPRrOL5y0Lmv1kz3U0mR

# ã‚»ãƒ³ãƒˆãƒ©ãƒ«ã‚¨ã‚¢ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠã®ä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡è¨ˆç®—

# Google Drive ã®ãƒã‚¦ãƒ³ãƒˆ
"""

#from google.colab import drive
#drive.mount('/content/drive')

"""# ãƒ•ã‚©ãƒ«ãƒ€ã®è¨­å®š"""

import os
import sys
import numpy as np
import pandas as pd

# Commented out IPython magic to ensure Python compatibility.
#sys.path.append('./')
# %cd ./
# %pwd

#!pip install japanize-matplotlib                                                        
#import japanize_matplotlib                                                              #æ—¥æœ¬èªåŒ–matplotlibã‚’import     ã‚°ãƒ©ãƒ•æç”»
import matplotlib.pyplot as plt                                                         #matplotlib.pyplotã‚’import      ã‚°ãƒ©ãƒ•æç”»
import matplotlib.dates as mdates                                                       #matplotlib.pyplotã‚’import      ã‚°ãƒ©ãƒ•æç”»
import matplotlib as mpl                                                                #matplotlibã‚’import             ã‚°ãƒ©ãƒ•æç”»

from datetime import datetime, timedelta                                                #æ—¥ä»˜

"""# section4-CRAC.py"""

# ãƒ€ã‚¯ãƒˆå¼ã‚»ãƒ³ãƒˆãƒ©ãƒ«ç©ºèª¿æ©Ÿ
import pyhees.section4_2 as dc
import pyhees.section4_2_a as dc_a
import pyhees.section4_2_b as dc_spec

# ã‚¨ã‚¢ãƒ¼ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠãƒ¼
import pyhees.section4_3 as rac
import pyhees.section4_3_a as rac_spec

#åºŠä¸‹
import pyhees.section3_1_e as uf

from functools import lru_cache

import datetime

import pyhees.section3_1 as ld

from pyhees.section3_2_8 import \
    get_r_env

from pyhees.section11_1 import \
    load_outdoor, \
    get_T_ex, \
    get_Theta_ex, \
    get_X_ex, \
    calc_h_ex, \
    load_climate, \
    get_J

from pyhees.section3_1 import \
    get_A_NR

from pyhees.section4_7_i import \
    get_A_A_R

from pyhees.section11_3 import \
    load_schedule, \
    get_schedule_ac

# æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®æš–æˆ¿æ™‚ã®æ¶ˆè²»é›»åŠ›é‡ï¼ˆkWh/hï¼‰(1)
def calc_CRAC_E_E_H_d_t(Theta_hs_out_d_t, Theta_hs_in_d_t, V_hs_supply_d_t, V_hs_vent_d_t, C_df_H_d_t,
           V_hs_dsgn_H, P_fan_rtd_H, region, q_rtd_C, q_rtd_H, e_rtd_H):

    df_output = pd.DataFrame(index =pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'))

    # (3)
    q_hs_H_d_t = dc_a.get_q_hs_H_d_t(Theta_hs_out_d_t, Theta_hs_in_d_t, V_hs_supply_d_t, C_df_H_d_t, region)

    E_E_CRAC_H_d_t = rac.calc_E_E_H_d_t(region, q_rtd_C, q_rtd_H, e_rtd_H, False, q_hs_H_d_t * 3.6 / 1000)

    # (37)
    E_E_fan_H_d_t = dc_a.get_E_E_fan_H_d_t(P_fan_rtd_H, V_hs_vent_d_t, V_hs_supply_d_t, V_hs_dsgn_H, q_hs_H_d_t * 3.6 / 1000)

    df_output['q_hs_H_d_t'] = q_hs_H_d_t
    df_output['E_E_CRAC_H_d_t'] = E_E_CRAC_H_d_t
    df_output['E_E_fan_H_d_t'] = E_E_fan_H_d_t

    # (1)
    E_E_H_d_t = E_E_CRAC_H_d_t + E_E_fan_H_d_t

    print('ã€calc_CRAC_E_E_H_d_tã€‘')

    fig=plt.figure(facecolor = 'w', figsize = (15, 2))
    ax = fig.add_subplot(1, 1, 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), q_hs_H_d_t, linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ©Ÿã®å¹³å‡æš–æˆ¿èƒ½åŠ› (W)')                                                                           
    ax.set_ylim(0, 8000)
    plt.show() 

    fig=plt.figure(facecolor = 'w',figsize = (15, 2))
    ax = fig.add_subplot(1, 1, 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_E_CRAC_H_d_t, linewidth = 0.5)
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_E_fan_H_d_t, linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('æ¶ˆè²»é›»åŠ›é‡ã€€ï¼ˆkWh/hï¼‰')                                                                           
    ax.set_ylim(0, 5)
    plt.show() 

    df_output.to_csv('./output_CRAC_heating.csv')
    return E_E_H_d_t

def get_q_hs_C_d_t_2(Theta_hs_out_d_t, Theta_hs_in_d_t, X_hs_out_d_t, X_hs_in_d_t,V_hs_supply_d_t, region):
    """(4a-1)(4b-1)(4c-1)(4a-2)(4b-2)(4c-2)(4a-3)(4b-3)(4c-3)

    :param Theta_hs_out_d_t:æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦ï¼ˆâ„ƒï¼‰
    :param Theta_hs_in_d_t:æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ç†±æºæ©Ÿã®å…¥å£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦ï¼ˆâ„ƒï¼‰
    :param X_hs_out_d_t:æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹çµ¶å¯¾æ¹¿åº¦ï¼ˆkg/kg(DA)ï¼‰
    :param X_hs_in_d_t:æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ç†±æºæ©Ÿã®å…¥å£ã«ãŠã‘ã‚‹çµ¶å¯¾æ¹¿åº¦ï¼ˆkg/kg(DA)ï¼‰
    :param V_hs_supply_d_t:æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹ç†±æºæ©Ÿã®é¢¨é‡ï¼ˆm3/hï¼‰
    :param region:åœ°åŸŸåŒºåˆ†
    :return:æ—¥ä»˜dã®æ™‚åˆ»tã«ãŠã‘ã‚‹1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ©Ÿã®å¹³å‡å†·æˆ¿èƒ½åŠ›ï¼ˆ-ï¼‰
    """
    H, C, M = dc_a.get_season_array_d_t(region)
    c_p_air = dc_a.get_c_p_air()
    rho_air = dc_a.get_rho_air()
    L_wtr = dc_a.get_L_wtr()

    # æš–æˆ¿æœŸãŠã‚ˆã³ä¸­é–“æœŸ (4a-1)(4b-1)(4c-1)(4a-3)(4b-3)(4c-3)
    q_hs_C_d_t = np.zeros(24 * 365)
    q_hs_CS_d_t = np.zeros(24 * 365)
    q_hs_CL_d_t = np.zeros(24 * 365)

    # å†·æˆ¿æœŸ (4a-2)(4b-2)(4c-2)
    q_hs_CS_d_t[C] = np.clip(c_p_air * rho_air * (Theta_hs_in_d_t[C] - Theta_hs_out_d_t[C]) * (V_hs_supply_d_t[C] / 3600), 0, None)

    Cf = np.logical_and(C, q_hs_CS_d_t > 0)

    q_hs_CL_d_t[Cf] = np.clip(L_wtr * rho_air * (X_hs_in_d_t[Cf] - X_hs_out_d_t[Cf]) * (V_hs_supply_d_t[Cf] / 3600) * 10 ** 3, 0, None)

    return  q_hs_CS_d_t, q_hs_CL_d_t

def get_CRAC_E_E_C_d_t(Theta_hs_out_d_t, Theta_hs_in_d_t,  X_hs_out_d_t, X_hs_in_d_t, V_hs_supply_d_t, V_hs_vent_d_t,
                  q_rtd_C, e_rtd_C, V_hs_dsgn_C, P_fan_rtd_C, region):

    df_output = pd.DataFrame(index =pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'))

    # å¤–æ°—æ¡ä»¶
    #outdoor = load_outdoor()
    outdoor = pd.read_csv('samples/outdoor_mitaka.csv', skiprows=4, nrows=24 * 365, names=(
    'day', 'hour', 'holiday', 'Theta_ex_1', 'X_ex_1'))

    #Theta_ex_d_t = get_Theta_ex(region, outdoor)
    Theta_ex_d_t = outdoor['Theta_ex_1'].values

    # (4)
    q_hs_CS_d_t, q_hs_CL_d_t = get_q_hs_C_d_t_2(Theta_hs_out_d_t, Theta_hs_in_d_t, X_hs_out_d_t, X_hs_in_d_t, V_hs_supply_d_t, region)

    E_E_CRAC_C_d_t = rac.calc_E_E_C_d_t(region, q_rtd_C, e_rtd_C, False, q_hs_CS_d_t * 3.6 / 1000, q_hs_CL_d_t * 3.6 / 1000)

    # (38)
    E_E_fan_C_d_t = dc_a.get_E_E_fan_C_d_t(P_fan_rtd_C, V_hs_vent_d_t, V_hs_supply_d_t, V_hs_dsgn_C, q_hs_CS_d_t * 3.6 / 1000 + q_hs_CL_d_t * 3.6 / 1000)

    df_output['q_hs_CS_d_t'] = q_hs_CS_d_t
    df_output['q_hs_CL_d_t'] = q_hs_CL_d_t
    df_output['E_E_CRAC_C_d_t'] = E_E_CRAC_C_d_t
    df_output['E_E_fan_C_d_t'] = E_E_fan_C_d_t

    # (2)
    E_E_C_d_t = E_E_CRAC_C_d_t + E_E_fan_C_d_t

    print('ã€get_CRAC_E_E_C_d_tã€‘')

    fig=plt.figure(facecolor = 'w', figsize = (15, 2))
    ax = fig.add_subplot(1, 1, 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), q_hs_CS_d_t, linewidth = 0.5)
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), q_hs_CL_d_t, linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('1æ™‚é–“å½“ãŸã‚Šã®ç†±æºæ©Ÿã®å¹³å‡å†·æˆ¿èƒ½åŠ› (W)')                                                                           
    ax.set_ylim(0, 8000)
    plt.show() 

    fig=plt.figure(facecolor = 'w',figsize = (15, 2))
    ax = fig.add_subplot(1, 1, 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_E_CRAC_C_d_t, linewidth = 0.5)
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_E_fan_C_d_t, linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('æ¶ˆè²»é›»åŠ›é‡ã€€ï¼ˆkWh/hï¼‰')                                                                           
    ax.set_ylim(0, 5)
    plt.show() 

    df_output.to_csv('./output_CRAC_cooling.csv')

    return E_E_C_d_t

# æœªå‡¦ç†è² è·ã¨æ©Ÿå™¨ã®è¨ˆç®—ã«å¿…è¦ãªå¤‰æ•°ã‚’å–å¾—
def calc_CRAC_Q_UT_A(A_A, A_MR, A_OR, A_env, mu_H, mu_C, q_rtd_C, q_rtd_H, q_max_C, q_max_H, V_hs_dsgn_H, V_hs_dsgn_C, Q,
             VAV, general_ventilation, duct_insulation, region, L_H_d_t_i, L_CS_d_t_i, L_CL_d_t_i):

    df_output = pd.DataFrame(index =pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'))
    df_output2 = pd.DataFrame()

    # å¤–æ°—æ¡ä»¶
    #outdoor = load_outdoor()

    outdoor = pd.read_csv('samples/outdoor_mitaka.csv', skiprows=4, nrows=24 * 365, names=(
    'day', 'hour', 'holiday', 'Theta_ex_1', 'X_ex_1'))

    #Theta_ex_d_t = get_Theta_ex(region, outdoor)
    #X_ex_d_t = get_X_ex(region, outdoor)
    Theta_ex_d_t = outdoor['Theta_ex_1'].values
    X_ex_d_t = outdoor['X_ex_1'].values

    #climate = load_climate(region)
    climate = pd.read_csv('samples/climateData_6_mitaka.csv', nrows=24 * 365)
    
    #J_d_t = get_J(climate)
    J_d_t = climate["æ°´å¹³é¢å¤©ç©ºæ—¥å°„é‡ [W/m2]"].values
    h_ex_d_t = calc_h_ex(X_ex_d_t, Theta_ex_d_t)


    df_output['Theta_ex_d_t'] = Theta_ex_d_t
    df_output['X_ex_d_t'] = X_ex_d_t
    df_output['J_d_t'] = J_d_t

    print('ã€calc_CRAC_Q_UT_Aã€‘')
    
    fig=plt.figure(facecolor = 'w', figsize = (15, 2))
    ax = fig.add_subplot(1, 1, 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), Theta_ex_d_t, linewidth = 0.5)
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), X_ex_d_t, linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('æ¸©åº¦ï¼ˆâ„ƒï¼‰ã€çµ¶å¯¾æ¹¿åº¦ï¼ˆg/kgï¼‰')                                                                           
    ax.set_ylim(-10, 40)
    plt.show() 

    fig=plt.figure(facecolor = 'w', figsize = (15, 2))
    ax = fig.add_subplot(1, 1, 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), J_d_t, linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('æ°´å¹³é¢å…¨å¤©æ—¥å°„é‡ï¼ˆW/m2ï¼‰')                                                                           
    ax.set_ylim(0, 500)
    plt.show() 

    #ä¸»ãŸã‚‹å±…å®¤ãƒ»ãã®ä»–å±…å®¤ãƒ»éå±…å®¤ã®é¢ç©
    A_HCZ_i = np.array([ld.get_A_HCZ_i(i, A_A, A_MR, A_OR) for i in range(1, 6)])
    A_HCZ_R_i = [ld.get_A_HCZ_R_i(i) for i in range(1, 6)]
    A_NR = get_A_NR(A_A, A_MR, A_OR)

    df_output2['A_HCZ_i'] = A_HCZ_i
    df_output2['A_HCZ_R_i'] = A_HCZ_R_i
    df_output2['A_NR'] = A_NR

    # (67)  æ°´ã®è’¸ç™ºæ½œç†±
    L_wtr = dc.get_L_wtr()
    df_output2['L_wtr'] = L_wtr

    # (66d)ã€€éå±…å®¤ã®åœ¨å®¤äººæ•°
    n_p_NR_d_t = dc.calc_n_p_NR_d_t(A_NR)
    df_output['n_p_NR_d_t'] = n_p_NR_d_t

    # (66c)ã€€ãã®ä»–å±…å®¤ã®åœ¨å®¤äººæ•°
    n_p_OR_d_t = dc.calc_n_p_OR_d_t(A_OR)
    df_output['n_p_OR_d_t'] = n_p_OR_d_t

    # (66b)ã€€ä¸»ãŸã‚‹å±…å®¤ã®åœ¨å®¤äººæ•°
    n_p_MR_d_t = dc.calc_n_p_MR_d_t(A_MR)
    df_output['n_p_MR_d_t'] = n_p_MR_d_t

    # (66a)ã€€åœ¨å®¤äººæ•°
    n_p_d_t = dc.get_n_p_d_t(n_p_MR_d_t, n_p_OR_d_t, n_p_NR_d_t)
    df_output['n_p_d_t'] = n_p_d_t

    # äººä½“ç™ºç†±
    q_p_H = dc.get_q_p_H()
    q_p_CS = dc.get_q_p_CS()
    q_p_CL = dc.get_q_p_CL()
    df_output2['q_p_H'] = q_p_H
    df_output2['q_p_CS'] = q_p_CS
    df_output2['q_p_CL'] = q_p_CL

    # (65d)ã€€éå±…å®¤ã®å†…éƒ¨ç™ºæ¹¿
    w_gen_NR_d_t = dc.calc_w_gen_NR_d_t(A_NR)
    df_output['w_gen_NR_d_t'] = w_gen_NR_d_t

    # (65c)ã€€ãã®ä»–å±…å®¤ã®å†…éƒ¨ç™ºæ¹¿
    w_gen_OR_d_t = dc.calc_w_gen_OR_d_t(A_OR)
    df_output['w_gen_OR_d_t'] = w_gen_OR_d_t

    # (65b)ã€€ä¸»ãŸã‚‹å±…å®¤ã®å†…éƒ¨ç™ºæ¹¿
    w_gen_MR_d_t = dc.calc_w_gen_MR_d_t(A_MR)
    df_output['w_gen_MR_d_t'] = w_gen_MR_d_t

    # (65a)ã€€å†…éƒ¨ç™ºæ¹¿
    w_gen_d_t = dc.get_w_gen_d_t(w_gen_MR_d_t, w_gen_OR_d_t, w_gen_NR_d_t)
    df_output['w_gen_d_t'] = w_gen_d_t

    # (64d)ã€€éå±…å®¤ã®å†…éƒ¨ç™ºç†±
    q_gen_NR_d_t = dc.calc_q_gen_NR_d_t(A_NR)
    df_output['q_gen_NR_d_t'] = q_gen_NR_d_t

    # (64c)ã€€ãã®ä»–å±…å®¤ã®å†…éƒ¨ç™ºç†±
    q_gen_OR_d_t = dc.calc_q_gen_OR_d_t(A_OR)
    df_output['q_gen_OR_d_t'] = q_gen_OR_d_t

    # (64b)ã€€ä¸»ãŸã‚‹å±…å®¤ã®å†…éƒ¨ç™ºç†±
    q_gen_MR_d_t = dc.calc_q_gen_MR_d_t(A_MR)
    df_output['q_gen_MR_d_t'] = q_gen_MR_d_t

    # (64a)ã€€å†…éƒ¨ç™ºç†±
    q_gen_d_t = dc.get_q_gen_d_t(q_gen_MR_d_t, q_gen_OR_d_t, q_gen_NR_d_t)
    df_output['q_gen_d_t'] = q_gen_d_t

    # (63)ã€€å±€æ‰€æ’æ°—é‡
    V_vent_l_NR_d_t = dc.get_V_vent_l_NR_d_t()
    V_vent_l_OR_d_t = dc.get_V_vent_l_OR_d_t()
    V_vent_l_MR_d_t = dc.get_V_vent_l_MR_d_t()
    V_vent_l_d_t = dc.get_V_vent_l_d_t(V_vent_l_MR_d_t, V_vent_l_OR_d_t, V_vent_l_NR_d_t)

    df_output['V_vent_l_NR_d_t'] = V_vent_l_NR_d_t
    df_output['V_vent_l_OR_d_t'] = V_vent_l_OR_d_t
    df_output['V_vent_l_MR_d_t'] = V_vent_l_MR_d_t
    df_output['V_vent_l_d_t'] = V_vent_l_d_t

    # (62)ã€€å…¨èˆ¬æ›æ°—é‡
    V_vent_g_i = dc.get_V_vent_g_i(A_HCZ_i, A_HCZ_R_i)
    df_output2['V_vent_g_i'] = V_vent_g_i

    # (61)ã€€é–“ä»•åˆ‡ã®ç†±è²«æµç‡
    U_prt = dc.get_U_prt()
    df_output2['U_prt'] = U_prt

    # (60)ã€€éå±…å®¤ã®é–“ä»•åˆ‡ã®é¢ç©
    r_env = get_r_env(A_env, A_A)
    A_prt_i = dc.get_A_prt_i(A_HCZ_i, r_env, A_MR, A_NR, A_OR)
    df_output2['r_env'] = r_env
    df_output2['A_prt_i'] = A_prt_i

    # (59)ã€€ç­‰ä¾¡å¤–æ°—æ¸©åº¦
    Theta_SAT_d_t = dc.get_Theta_SAT_d_t(Theta_ex_d_t, J_d_t)
    df_output['Theta_SAT_d_t'] = Theta_SAT_d_t

    # (58)ã€€æ–­ç†±åŒºç”»å¤–ã‚’é€šã‚‹ãƒ€ã‚¯ãƒˆã®é•·ã•
    l_duct_ex_i = dc.get_l_duct_ex_i(A_A)
    df_output2['l_duct_ex_i'] = l_duct_ex_i

    # (57)ã€€æ–­ç†±åŒºç”»å†…ã‚’é€šã‚‹ãƒ€ã‚¯ãƒˆé•·ã•
    l_duct_in_i = dc.get_l_duct_in_i(A_A)
    df_output2['l_duct_in_i'] = l_duct_in_i

    # (56)ã€€ãƒ€ã‚¯ãƒˆé•·ã•
    l_duct_i = dc.get_l_duct__i(l_duct_in_i, l_duct_ex_i)
    df_output2['l_duct_i'] = l_duct_i

    # (51)ã€€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®å±…å®¤ã®çµ¶å¯¾æ¹¿åº¦
    X_star_HBR_d_t = dc.get_X_star_HBR_d_t(X_ex_d_t, region)
    df_output['X_star_HBR_d_t'] = X_star_HBR_d_t

    # (50)ã€€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®å±…å®¤ã®å®¤æ¸©
    Theta_star_HBR_d_t = dc.get_Theta_star_HBR_d_t(Theta_ex_d_t, region)
    df_output['Theta_star_HBR_d_t'] = Theta_star_HBR_d_t   

    # (55)ã€€å°å±‹è£ã®ç©ºæ°—æ¸©åº¦
    Theta_attic_d_t = dc.get_Theta_attic_d_t(Theta_SAT_d_t, Theta_star_HBR_d_t)
    df_output['Theta_attic_d_t'] = Theta_attic_d_t     

    # (54)ã€€ãƒ€ã‚¯ãƒˆã®å‘¨å›²ã®ç©ºæ°—æ¸©åº¦
    Theta_sur_d_t_i = dc.get_Theta_sur_d_t_i(Theta_star_HBR_d_t, Theta_attic_d_t, l_duct_in_i, l_duct_ex_i, duct_insulation)
    df_output['Theta_sur_d_t_i_1'] = Theta_sur_d_t_i[0]
    df_output['Theta_sur_d_t_i_2'] = Theta_sur_d_t_i[1]
    df_output['Theta_sur_d_t_i_3'] = Theta_sur_d_t_i[2]
    df_output['Theta_sur_d_t_i_4'] = Theta_sur_d_t_i[3]
    df_output['Theta_sur_d_t_i_5'] = Theta_sur_d_t_i[4]

    # (40)ã€€ç†±æºæ©Ÿã®é¢¨é‡ã‚’è¨ˆç®—ã™ã‚‹ãŸã‚ã®ç†±æºæ©Ÿã®å‡ºåŠ›
    Q_hat_hs_d_t = dc.calc_Q_hat_hs_d_t(Q, A_A, V_vent_l_d_t, V_vent_g_i, mu_H, mu_C, J_d_t, q_gen_d_t, n_p_d_t, q_p_H,
                                     q_p_CS, q_p_CL, X_ex_d_t, w_gen_d_t, Theta_ex_d_t, L_wtr, region)

    df_output['Q_hat_hs_d_t'] = Q_hat_hs_d_t

    # (39)ã€€ç†±æºæ©Ÿã®æœ€ä½é¢¨é‡
    V_hs_min = dc.get_V_hs_min(V_vent_g_i)
    df_output2['V_hs_min'] = V_hs_min    

    ####################################################################################################################
    # (38)ã€€å†·æˆ¿æ™‚ã®ç†±æºæ©Ÿã®å®šæ ¼å‡ºåŠ›
    Q_hs_rtd_C = dc.get_Q_hs_rtd_C(q_rtd_C)             #ãƒ«ãƒ¼ãƒ ã‚¨ã‚¢ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠã®å®šæ ¼èƒ½åŠ› q_rtd_C ã‚’å…¥åŠ›ã™ã‚‹ã‚ˆã†æ›¸ãæ›ãˆ
    df_output2['Q_hs_rtd_C'] = Q_hs_rtd_C  

    # (37)ã€€æš–æˆ¿æ™‚ã®ç†±æºæ©Ÿã®å®šæ ¼å‡ºåŠ›
    Q_hs_rtd_H = dc.get_Q_hs_rtd_H(q_rtd_H)             #ãƒ«ãƒ¼ãƒ ã‚¨ã‚¢ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠã®å®šæ ¼èƒ½åŠ› q_rtd_H ã‚’å…¥åŠ›ã™ã‚‹ã‚ˆã†æ›¸ãæ›ãˆ
    df_output2['Q_hs_rtd_H'] = Q_hs_rtd_H 
    ####################################################################################################################

    # (36)ã€€VAV èª¿æ•´å‰ã®ç†±æºæ©Ÿã®é¢¨é‡
    if CAV:
        H, C, M = dc_a.get_season_array_d_t(region)
        V_dash_hs_supply_d_t = np.zeros(24 * 365)
        V_dash_hs_supply_d_t[H] = V_hs_dsgn_H
        V_dash_hs_supply_d_t[C] = V_hs_dsgn_C
        V_dash_hs_supply_d_t[M] = (V_hs_dsgn_H + V_hs_dsgn_C) / 2
    else:
        V_dash_hs_supply_d_t = dc.get_V_dash_hs_supply_d_t(V_hs_min, V_hs_dsgn_H, V_hs_dsgn_C, Q_hs_rtd_H, Q_hs_rtd_C, Q_hat_hs_d_t, region)
    
    df_output['V_dash_hs_supply_d_t'] = V_dash_hs_supply_d_t

    # (45)ã€€é¢¨é‡ãƒãƒ©ãƒ³ã‚¹
    r_supply_des_i = dc.get_r_supply_des_i(A_HCZ_i)
    df_output2['r_supply_des_i'] = r_supply_des_i

    # (44)ã€€VAV èª¿æ•´å‰ã®å¹ãå‡ºã—é¢¨é‡
    V_dash_supply_d_t_i = dc.get_V_dash_supply_d_t_i(r_supply_des_i, V_dash_hs_supply_d_t, V_vent_g_i)
    df_output['V_dash_supply_d_t_1'] = V_dash_supply_d_t_i[0]
    df_output['V_dash_supply_d_t_2'] = V_dash_supply_d_t_i[1]
    df_output['V_dash_supply_d_t_3'] = V_dash_supply_d_t_i[2]
    df_output['V_dash_supply_d_t_4'] = V_dash_supply_d_t_i[3]
    df_output['V_dash_supply_d_t_5'] = V_dash_supply_d_t_i[4]

    # (53)ã€€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®éå±…å®¤ã®çµ¶å¯¾æ¹¿åº¦
    X_star_NR_d_t = dc.get_X_star_NR_d_t(X_star_HBR_d_t, L_CL_d_t_i, L_wtr, V_vent_l_NR_d_t, V_dash_supply_d_t_i, region)
    df_output['X_star_NR_d_t'] = X_star_NR_d_t

    # (52)ã€€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®éå±…å®¤ã®å®¤æ¸©
    Theta_star_NR_d_t = dc.get_Theta_star_NR_d_t(Theta_star_HBR_d_t, Q, A_NR, V_vent_l_NR_d_t, V_dash_supply_d_t_i, U_prt,
                                              A_prt_i, L_H_d_t_i, L_CS_d_t_i, region)
    df_output['Theta_star_NR_d_t'] = Theta_star_NR_d_t

    # (49)ã€€å®Ÿéš›ã®éå±…å®¤ã®çµ¶å¯¾æ¹¿åº¦
    X_NR_d_t = dc.get_X_NR_d_t(X_star_NR_d_t)
    df_output['X_NR_d_t'] = X_NR_d_t    

    # (47)ã€€å®Ÿéš›ã®å±…å®¤ã®çµ¶å¯¾æ¹¿åº¦
    X_HBR_d_t_i = dc.get_X_HBR_d_t_i(X_star_HBR_d_t)
    df_output['X_HBR_d_t_1'] = X_HBR_d_t_i[0]  
    df_output['X_HBR_d_t_2'] = X_HBR_d_t_i[1]  
    df_output['X_HBR_d_t_3'] = X_HBR_d_t_i[2]  
    df_output['X_HBR_d_t_4'] = X_HBR_d_t_i[3]     
    df_output['X_HBR_d_t_5'] = X_HBR_d_t_i[4]  

    # (11)ã€€ç†±æå¤±ã‚’å«ã‚€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®éå±…å®¤ã¸ã®ç†±ç§»å‹•
    Q_star_trs_prt_d_t_i = dc.get_Q_star_trs_prt_d_t_i(U_prt, A_prt_i, Theta_star_HBR_d_t, Theta_star_NR_d_t)
    df_output['Q_star_trs_prt_d_t_i_1'] = Q_star_trs_prt_d_t_i[0]  
    df_output['Q_star_trs_prt_d_t_i_2'] = Q_star_trs_prt_d_t_i[1]  
    df_output['Q_star_trs_prt_d_t_i_3'] = Q_star_trs_prt_d_t_i[2]  
    df_output['Q_star_trs_prt_d_t_i_4'] = Q_star_trs_prt_d_t_i[3]     
    df_output['Q_star_trs_prt_d_t_i_5'] = Q_star_trs_prt_d_t_i[4]  

    # (10)ã€€ç†±å–å¾—ã‚’å«ã‚€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®å†·æˆ¿æ½œç†±è² è·
    L_star_CL_d_t_i = dc.get_L_star_CL_d_t_i(L_CS_d_t_i, L_CL_d_t_i, region)
    df_output['L_star_CL_d_t_i_1'] = L_star_CL_d_t_i[0]  
    df_output['L_star_CL_d_t_i_2'] = L_star_CL_d_t_i[1]  
    df_output['L_star_CL_d_t_i_3'] = L_star_CL_d_t_i[2]  
    df_output['L_star_CL_d_t_i_4'] = L_star_CL_d_t_i[3]  
    df_output['L_star_CL_d_t_i_5'] = L_star_CL_d_t_i[4]  

    # (9)ã€€ç†±å–å¾—ã‚’å«ã‚€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®å†·æˆ¿é¡•ç†±è² è·
    L_star_CS_d_t_i = dc.get_L_star_CS_d_t_i(L_CS_d_t_i, Q_star_trs_prt_d_t_i, region)
    df_output['L_star_CS_d_t_i_1'] = L_star_CS_d_t_i[0]  
    df_output['L_star_CS_d_t_i_2'] = L_star_CS_d_t_i[1]  
    df_output['L_star_CS_d_t_i_3'] = L_star_CS_d_t_i[2]  
    df_output['L_star_CS_d_t_i_4'] = L_star_CS_d_t_i[3]  
    df_output['L_star_CS_d_t_i_5'] = L_star_CS_d_t_i[4]  

    # (8)ã€€ç†±æå¤±ã‚’å«ã‚€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®æš–æˆ¿è² è·
    L_star_H_d_t_i = dc.get_L_star_H_d_t_i(L_H_d_t_i, Q_star_trs_prt_d_t_i, region)
    df_output['L_star_H_d_t_i_1'] = L_star_H_d_t_i[0]  
    df_output['L_star_H_d_t_i_2'] = L_star_H_d_t_i[1]  
    df_output['L_star_H_d_t_i_3'] = L_star_H_d_t_i[2]  
    df_output['L_star_H_d_t_i_4'] = L_star_H_d_t_i[3]  
    df_output['L_star_H_d_t_i_5'] = L_star_H_d_t_i[4]  

    ####################################################################################################################
    # (24)ã€€ãƒ‡ãƒ•ãƒ­ã‚¹ãƒˆã«é–¢ã™ã‚‹æš–æˆ¿å‡ºåŠ›è£œæ­£ä¿‚æ•°
    #C_df_H_d_t = dc.get_C_df_H_d_t(Theta_ex_d_t, h_ex_d_t)
    C_df_H_d_t = dc.get_C_df_H_d_t(30, h_ex_d_t)                                                                        #å¿…ãš1ã«ãªã‚‹ã‚ˆã†è¨­å®šï¼ˆæš«å®šï¼‰
    df_output['C_df_H_d_t'] = C_df_H_d_t

    # æœ€å¤§æš–æˆ¿èƒ½åŠ›æ¯”
    q_r_max_H = rac.get_q_r_max_H(q_max_H, q_rtd_H)
    df_output2['q_r_max_H'] = q_r_max_H

    # æœ€å¤§æš–æˆ¿å‡ºåŠ›æ¯”
    Q_r_max_H_d_t = rac.calc_Q_r_max_H_d_t(q_rtd_C, q_r_max_H, Theta_ex_d_t)
    df_output['Q_r_max_H_d_t'] = Q_r_max_H_d_t

    # æœ€å¤§æš–æˆ¿å‡ºåŠ›
    Q_max_H_d_t = rac.calc_Q_max_H_d_t(Q_r_max_H_d_t, q_rtd_H, Theta_ex_d_t, h_ex_d_t)
    Q_hs_max_H_d_t = Q_max_H_d_t
    df_output['Q_hs_max_H_d_t'] = Q_hs_max_H_d_t

    # æœ€å¤§å†·æˆ¿èƒ½åŠ›æ¯”
    q_r_max_C = rac.get_q_r_max_C(q_max_C, q_rtd_C)
    df_output2['q_r_max_C'] = q_r_max_C

    # æœ€å¤§å†·æˆ¿å‡ºåŠ›æ¯”
    Q_r_max_C_d_t = rac.calc_Q_r_max_C_d_t(q_r_max_C, q_rtd_C, Theta_ex_d_t)
    df_output['Q_r_max_C_d_t'] = Q_r_max_C_d_t

    # æœ€å¤§å†·æˆ¿å‡ºåŠ›
    Q_max_C_d_t = rac.calc_Q_max_C_d_t(Q_r_max_C_d_t, q_rtd_C)

    # å†·æˆ¿è² è·æœ€å°é¡•ç†±æ¯”
    SHF_L_min_c = rac.get_SHF_L_min_c()
    df_output2['SHF_L_min_c'] = SHF_L_min_c

    # æœ€å¤§å†·æˆ¿æ½œç†±è² è·
    L_max_CL_d_t = rac.get_L_max_CL_d_t(np.sum(L_CS_d_t_i, axis=0), SHF_L_min_c)
    df_output['L_max_CL_d_t'] = L_max_CL_d_t

    # è£œæ­£å†·æˆ¿æ½œç†±è² è·
    L_dash_CL_d_t = rac.get_L_dash_CL_d_t(L_max_CL_d_t, np.sum(L_CL_d_t_i, axis=0))
    L_dash_C_d_t = rac.get_L_dash_C_d_t(np.sum(L_CS_d_t_i, axis=0), L_dash_CL_d_t)
    df_output['L_dash_CL_d_t'] = L_dash_CL_d_t
    df_output['L_dash_C_d_t'] = L_dash_C_d_t

    # å†·æˆ¿è² è·è£œæ­£é¡•ç†±æ¯”
    SHF_dash_d_t = rac.get_SHF_dash_d_t(np.sum(L_CS_d_t_i, axis=0), L_dash_C_d_t)
    df_output['SHF_dash_d_t'] = SHF_dash_d_t

    # æœ€å¤§å†·æˆ¿é¡•ç†±å‡ºåŠ›, æœ€å¤§å†·æˆ¿æ½œç†±å‡ºåŠ›
    Q_max_CS_d_t = rac.get_Q_max_CS_d_t(Q_max_C_d_t, SHF_dash_d_t)
    Q_max_CL_d_t = rac.get_Q_max_CL_d_t(Q_max_C_d_t, SHF_dash_d_t, L_dash_CL_d_t)
    Q_hs_max_C_d_t = Q_max_C_d_t
    Q_hs_max_CL_d_t = Q_max_CL_d_t
    Q_hs_max_CS_d_t = Q_max_CS_d_t
    df_output['Q_hs_max_C_d_t'] = Q_hs_max_C_d_t
    df_output['Q_hs_max_CL_d_t'] = Q_hs_max_CL_d_t
    df_output['Q_hs_max_CS_d_t'] = Q_hs_max_CS_d_t

    ####################################################################################################################

    # (20)ã€€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®ç†±æºæ©Ÿã®å…¥å£ã«ãŠã‘ã‚‹çµ¶å¯¾æ¹¿åº¦
    X_star_hs_in_d_t = dc.get_X_star_hs_in_d_t(X_star_NR_d_t)
    df_output['X_star_hs_in_d_t'] = X_star_hs_in_d_t

    # (19)ã€€è² è·ãƒãƒ©ãƒ³ã‚¹æ™‚ã®ç†±æºæ©Ÿã®å…¥å£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦
    Theta_star_hs_in_d_t = dc.get_Theta_star_hs_in_d_t(Theta_star_NR_d_t)
    df_output['Theta_star_hs_in_d_t'] = Theta_star_hs_in_d_t

    # (18)ã€€ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦ã®æœ€ä½å€¤
    X_hs_out_min_C_d_t = dc.get_X_hs_out_min_C_d_t(X_star_hs_in_d_t, Q_hs_max_CL_d_t, V_dash_supply_d_t_i)
    df_output['X_hs_out_min_C_d_t'] = X_hs_out_min_C_d_t

    # (22)ã€€ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹è¦æ±‚çµ¶å¯¾æ¹¿åº¦
    X_req_d_t_i = dc.get_X_req_d_t_i(X_star_HBR_d_t, L_star_CL_d_t_i, V_dash_supply_d_t_i, region)
    df_output['X_req_d_t_1'] = X_req_d_t_i[0]
    df_output['X_req_d_t_2'] = X_req_d_t_i[1]
    df_output['X_req_d_t_3'] = X_req_d_t_i[2]
    df_output['X_req_d_t_4'] = X_req_d_t_i[3]
    df_output['X_req_d_t_5'] = X_req_d_t_i[4]

    # (21)ã€€ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹è¦æ±‚ç©ºæ°—æ¸©åº¦
    Theta_req_d_t_i = dc.get_Theta_req_d_t_i(Theta_sur_d_t_i, Theta_star_HBR_d_t, V_dash_supply_d_t_i,
                        L_star_H_d_t_i, L_star_CS_d_t_i, l_duct_i, region)
    
    if YUCACO:
        Theta_uf_d_t, Theta_g_surf_d_t = uf.calc_Theta(region, A_A, A_MR, A_OR, Q, r_A_ufvnt, underfloor_insulation, Theta_req_d_t_i[0], Theta_ex_d_t,
                                                V_dash_supply_d_t_i[0], _, L_H_d_t_i, L_CS_d_t_i)
        Theta_req_d_t_i[0] += (Theta_req_d_t_i[0] - Theta_uf_d_t)
        Theta_uf_d_t, Theta_g_surf_d_t = uf.calc_Theta(region, A_A, A_MR, A_OR, Q, r_A_ufvnt, underfloor_insulation, Theta_req_d_t_i[1], Theta_ex_d_t,
                                                V_dash_supply_d_t_i[1], _, L_H_d_t_i, L_CS_d_t_i)
        Theta_req_d_t_i[1] += (Theta_req_d_t_i[1] - Theta_uf_d_t)

    df_output['Theta_req_d_t_1'] = Theta_req_d_t_i[0]
    df_output['Theta_req_d_t_2'] = Theta_req_d_t_i[1]
    df_output['Theta_req_d_t_3'] = Theta_req_d_t_i[2]
    df_output['Theta_req_d_t_4'] = Theta_req_d_t_i[3]
    df_output['Theta_req_d_t_5'] = Theta_req_d_t_i[4]

    # (15)ã€€ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹çµ¶å¯¾æ¹¿åº¦
    X_hs_out_d_t = dc.get_X_hs_out_d_t(X_NR_d_t, X_req_d_t_i, V_dash_supply_d_t_i, X_hs_out_min_C_d_t, L_star_CL_d_t_i, region)
    df_output['X_hs_out_d_t'] = X_hs_out_d_t

    # å¼(14)(46)(48)ã®æ¡ä»¶ã«åˆã‚ã›ã¦Theta_NR_d_tã‚’åˆæœŸåŒ–
    Theta_NR_d_t = np.zeros(24 * 365)

    # (17)ã€€å†·æˆ¿æ™‚ã®ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦ã®æœ€ä½å€¤
    Theta_hs_out_min_C_d_t = dc.get_Theta_hs_out_min_C_d_t(Theta_star_hs_in_d_t, Q_hs_max_CS_d_t, V_dash_supply_d_t_i)
    df_output['Theta_hs_out_min_C_d_t'] = Theta_hs_out_min_C_d_t

    # (16)ã€€æš–æˆ¿æ™‚ã®ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦ã®æœ€é«˜å€¤
    Theta_hs_out_max_H_d_t = dc.get_Theta_hs_out_max_H_d_t(Theta_star_hs_in_d_t, Q_hs_max_H_d_t, V_dash_supply_d_t_i)
    df_output['Theta_hs_out_max_H_d_t'] = Theta_hs_out_max_H_d_t

    # L_star_H_d_t_iï¼ŒL_star_CS_d_t_iã®æš–å†·æˆ¿åŒºç”»1ï½5ã‚’åˆç®—ã—0ä»¥ä¸Šã ã£ãŸå ´åˆã®é †åºã§è¨ˆç®—
    # (14)ã€€ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦
    Theta_hs_out_d_t = dc.get_Theta_hs_out_d_t(VAV, Theta_req_d_t_i, V_dash_supply_d_t_i,
                                            L_star_H_d_t_i, L_star_CS_d_t_i, region, Theta_NR_d_t,
                                            Theta_hs_out_max_H_d_t, Theta_hs_out_min_C_d_t)
    df_output['Theta_hs_out_d_t'] = Theta_hs_out_d_t

    # (43)ã€€æš–å†·æˆ¿åŒºç”»ğ‘–ã®å¹ãå‡ºã—é¢¨é‡
    V_supply_d_t_i = dc.get_V_supply_d_t_i(L_star_H_d_t_i, L_star_CS_d_t_i, Theta_sur_d_t_i, l_duct_i, Theta_star_HBR_d_t,
                                                    V_vent_g_i, V_dash_supply_d_t_i, VAV, region, Theta_hs_out_d_t)
    df_output['V_supply_d_t_1'] = V_supply_d_t_i[0]
    df_output['V_supply_d_t_2'] = V_supply_d_t_i[1]
    df_output['V_supply_d_t_3'] = V_supply_d_t_i[2]
    df_output['V_supply_d_t_4'] = V_supply_d_t_i[3]
    df_output['V_supply_d_t_5'] = V_supply_d_t_i[4]

    # (41)ã€€æš–å†·æˆ¿åŒºç”»ğ‘–ã®å¹ãå‡ºã—æ¸©åº¦
    Theta_supply_d_t_i = dc.get_Thata_supply_d_t_i(Theta_sur_d_t_i, Theta_hs_out_d_t, Theta_star_HBR_d_t, l_duct_i,
                                                   V_supply_d_t_i, L_star_H_d_t_i, L_star_CS_d_t_i, region)

    if YUCACO:
        Theta_uf_d_t, Theta_g_surf_d_t = uf.calc_Theta(region, A_A, A_MR, A_OR, Q, r_A_ufvnt, underfloor_insulation, Theta_supply_d_t_i[0], Theta_ex_d_t,
                                                V_dash_supply_d_t_i[0], _, L_H_d_t_i, L_CS_d_t_i)
        Theta_supply_d_t_i[0] -= (Theta_supply_d_t_i[0] - Theta_uf_d_t)
        Theta_uf_d_t, Theta_g_surf_d_t = uf.calc_Theta(region, A_A, A_MR, A_OR, Q, r_A_ufvnt, underfloor_insulation, Theta_supply_d_t_i[1], Theta_ex_d_t,
                                                V_dash_supply_d_t_i[1], _, L_H_d_t_i, L_CS_d_t_i)
        Theta_supply_d_t_i[1] -= (Theta_supply_d_t_i[1] - Theta_uf_d_t)

    df_output['Theta_supply_d_t_1'] = Theta_supply_d_t_i[0]
    df_output['Theta_supply_d_t_2'] = Theta_supply_d_t_i[1]
    df_output['Theta_supply_d_t_3'] = Theta_supply_d_t_i[2]
    df_output['Theta_supply_d_t_4'] = Theta_supply_d_t_i[3]
    df_output['Theta_supply_d_t_5'] = Theta_supply_d_t_i[4]

    # (46)ã€€æš–å†·æˆ¿åŒºç”»ğ‘–ã®å®Ÿéš›ã®å±…å®¤ã®å®¤æ¸©
    Theta_HBR_d_t_i = dc.get_Theta_HBR_d_t_i(Theta_star_HBR_d_t, V_supply_d_t_i, Theta_supply_d_t_i, U_prt, A_prt_i, Q,
                                             A_HCZ_i, L_star_H_d_t_i, L_star_CS_d_t_i, region)
    df_output['Theta_HBR_d_t_1'] = Theta_HBR_d_t_i[0]
    df_output['Theta_HBR_d_t_2'] = Theta_HBR_d_t_i[1]
    df_output['Theta_HBR_d_t_3'] = Theta_HBR_d_t_i[2]
    df_output['Theta_HBR_d_t_4'] = Theta_HBR_d_t_i[3]
    df_output['Theta_HBR_d_t_5'] = Theta_HBR_d_t_i[4]

    # (48)ã€€å®Ÿéš›ã®éå±…å®¤ã®å®¤æ¸©
    Theta_NR_d_t = dc.get_Theta_NR_d_t(Theta_star_NR_d_t, Theta_star_HBR_d_t, Theta_HBR_d_t_i, A_NR, V_vent_l_NR_d_t,
                                        V_dash_supply_d_t_i, V_supply_d_t_i, U_prt, A_prt_i, Q)
    df_output['Theta_NR_d_t'] = Theta_NR_d_t

     # L_star_H_d_t_iï¼ŒL_star_CS_d_t_iã®æš–å†·æˆ¿åŒºç”»1ï½5ã‚’åˆç®—ã—0ä»¥ä¸‹ã ã£ãŸå ´åˆã®ç‚ºã«å†è¨ˆç®—
     # (14)ã€€ç†±æºæ©Ÿã®å‡ºå£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦
    Theta_hs_out_d_t = dc.get_Theta_hs_out_d_t(VAV, Theta_req_d_t_i, V_dash_supply_d_t_i,
                                            L_star_H_d_t_i, L_star_CS_d_t_i, region, Theta_NR_d_t,
                                            Theta_hs_out_max_H_d_t, Theta_hs_out_min_C_d_t)
    df_output['Theta_hs_out_d_t'] = Theta_hs_out_d_t   

    # (42)ã€€æš–å†·æˆ¿åŒºç”»ğ‘–ã®å¹ãå‡ºã—çµ¶å¯¾æ¹¿åº¦
    X_supply_d_t_i = dc.get_X_supply_d_t_i(X_star_HBR_d_t, X_hs_out_d_t, L_star_CL_d_t_i, region)
    df_output['X_supply_d_t_1'] = X_supply_d_t_i[0] 
    df_output['X_supply_d_t_2'] = X_supply_d_t_i[1] 
    df_output['X_supply_d_t_3'] = X_supply_d_t_i[2] 
    df_output['X_supply_d_t_4'] = X_supply_d_t_i[3] 
    df_output['X_supply_d_t_5'] = X_supply_d_t_i[4] 

    # (35)ã€€ç†±æºæ©Ÿã®é¢¨é‡ã®ã†ã¡ã®å…¨èˆ¬æ›æ°—åˆ†
    V_hs_vent_d_t = dc.get_V_hs_vent_d_t(V_vent_g_i, general_ventilation)
    df_output['V_hs_vent_d_t'] = V_hs_vent_d_t 

    # (34)ã€€ç†±æºæ©Ÿã®é¢¨é‡
    V_hs_supply_d_t = dc.get_V_hs_supply_d_t(V_supply_d_t_i)
    df_output['V_hs_supply_d_t'] = V_hs_supply_d_t

    # (13)ã€€ç†±æºæ©Ÿã®å…¥å£ã«ãŠã‘ã‚‹çµ¶å¯¾æ¹¿åº¦
    X_hs_in_d_t = dc.get_X_hs_in_d_t(X_NR_d_t)
    df_output['X_hs_in_d_t'] = X_hs_in_d_t

    # (12)ã€€ç†±æºæ©Ÿã®å…¥å£ã«ãŠã‘ã‚‹ç©ºæ°—æ¸©åº¦
    Theta_hs_in_d_t = dc.get_Theta_hs_in_d_t(Theta_NR_d_t)
    df_output['Theta_hs_in_d_t'] = Theta_hs_in_d_t  

    # (7)ã€€é–“ä»•åˆ‡ã‚Šã®ç†±å–å¾—ã‚’å«ã‚€å®Ÿéš›ã®å†·æˆ¿æ½œç†±è² è·
    L_dash_CL_d_t_i = dc.get_L_dash_CL_d_t_i(V_supply_d_t_i, X_HBR_d_t_i, X_supply_d_t_i, region)
    df_output['L_dash_CL_d_t_1'] = L_dash_CL_d_t_i[0]
    df_output['L_dash_CL_d_t_2'] = L_dash_CL_d_t_i[1]
    df_output['L_dash_CL_d_t_3'] = L_dash_CL_d_t_i[2]
    df_output['L_dash_CL_d_t_4'] = L_dash_CL_d_t_i[3]
    df_output['L_dash_CL_d_t_5'] = L_dash_CL_d_t_i[4]

    # (6)ã€€é–“ä»•åˆ‡ã‚Šã®ç†±å–å¾—ã‚’å«ã‚€å®Ÿéš›ã®å†·æˆ¿é¡•ç†±è² è·
    L_dash_CS_d_t_i = dc.get_L_dash_CS_d_t_i(V_supply_d_t_i, Theta_supply_d_t_i, Theta_HBR_d_t_i, region)
    df_output['L_dash_CS_d_t_1'] = L_dash_CS_d_t_i[0]
    df_output['L_dash_CS_d_t_2'] = L_dash_CS_d_t_i[1]
    df_output['L_dash_CS_d_t_3'] = L_dash_CS_d_t_i[2]
    df_output['L_dash_CS_d_t_4'] = L_dash_CS_d_t_i[3]
    df_output['L_dash_CS_d_t_5'] = L_dash_CS_d_t_i[4]

    # (5)ã€€é–“ä»•åˆ‡ã‚Šã®ç†±æå¤±ã‚’å«ã‚€å®Ÿéš›ã®æš–æˆ¿è² è·
    L_dash_H_d_t_i = dc.get_L_dash_H_d_t_i(V_supply_d_t_i, Theta_supply_d_t_i, Theta_HBR_d_t_i, region)
    df_output['L_dash_H_d_t_1'] = L_dash_H_d_t_i[0]
    df_output['L_dash_H_d_t_2'] = L_dash_H_d_t_i[1]
    df_output['L_dash_H_d_t_3'] = L_dash_H_d_t_i[2]
    df_output['L_dash_H_d_t_4'] = L_dash_H_d_t_i[3]
    df_output['L_dash_H_d_t_5'] = L_dash_H_d_t_i[4] 

    # (4)ã€€å†·æˆ¿è¨­å‚™æ©Ÿå™¨ã®æœªå‡¦ç†å†·æˆ¿æ½œç†±è² è·
    Q_UT_CL_d_t_i = dc.get_Q_UT_CL_d_t_i(L_star_CL_d_t_i, L_dash_CL_d_t_i)
    df_output['Q_UT_CL_d_t_1'] = Q_UT_CL_d_t_i[0] 
    df_output['Q_UT_CL_d_t_2'] = Q_UT_CL_d_t_i[1] 
    df_output['Q_UT_CL_d_t_3'] = Q_UT_CL_d_t_i[2] 
    df_output['Q_UT_CL_d_t_4'] = Q_UT_CL_d_t_i[3] 
    df_output['Q_UT_CL_d_t_5'] = Q_UT_CL_d_t_i[4]   

    # (3)ã€€å†·æˆ¿è¨­å‚™æ©Ÿå™¨ã®æœªå‡¦ç†å†·æˆ¿é¡•ç†±è² è·
    Q_UT_CS_d_t_i =dc. get_Q_UT_CS_d_t_i(L_star_CS_d_t_i, L_dash_CS_d_t_i)
    df_output['Q_UT_CS_d_t_1'] = Q_UT_CS_d_t_i[0]
    df_output['Q_UT_CS_d_t_2'] = Q_UT_CS_d_t_i[1]
    df_output['Q_UT_CS_d_t_3'] = Q_UT_CS_d_t_i[2]
    df_output['Q_UT_CS_d_t_4'] = Q_UT_CS_d_t_i[3]
    df_output['Q_UT_CS_d_t_5'] = Q_UT_CS_d_t_i[4] 

    # (2)ã€€æš–æˆ¿è¨­å‚™æ©Ÿå™¨ç­‰ã®æœªå‡¦ç†æš–æˆ¿è² è·
    Q_UT_H_d_t_i = dc.get_Q_UT_H_d_t_i(L_star_H_d_t_i, L_dash_H_d_t_i)
    df_output['Q_UT_H_d_t_1'] = Q_UT_H_d_t_i[0]
    df_output['Q_UT_H_d_t_2'] = Q_UT_H_d_t_i[1]
    df_output['Q_UT_H_d_t_3'] = Q_UT_H_d_t_i[2]
    df_output['Q_UT_H_d_t_4'] = Q_UT_H_d_t_i[3]
    df_output['Q_UT_H_d_t_5'] = Q_UT_H_d_t_i[4]

    # (1)ã€€å†·æˆ¿è¨­å‚™ã®æœªå‡¦ç†å†·æˆ¿è² è·ã®è¨­è¨ˆä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡ç›¸å½“å€¤
    E_C_UT_d_t = dc.get_E_C_UT_d_t(Q_UT_CL_d_t_i, Q_UT_CS_d_t_i, region)
    df_output['E_C_UT_d_t'] = E_C_UT_d_t

    if V_hs_dsgn_C == 0:
        df_output.to_csv('./output0_CRAC_heating.csv')
        df_output2.to_csv('./output2_CRAC_heating.csv')
    else:
        df_output.to_csv('./output0_CRAC_cooling.csv')
        df_output2.to_csv('./output2_CRAC_cooling.csv')

    return E_C_UT_d_t, Q_UT_H_d_t_i, Q_UT_CS_d_t_i, Q_UT_CL_d_t_i, Theta_hs_out_d_t, Theta_hs_in_d_t, \
           X_hs_out_d_t, X_hs_in_d_t, V_hs_supply_d_t, V_hs_vent_d_t, C_df_H_d_t

"""# calc_CRAC.py"""

import os
import sys
import numpy as np

from pyhees.section2_1_b import get_f_prim
from pyhees.section3_1 import get_Q
from pyhees.section3_2 import calc_r_env, get_Q_dash, get_eta_H, get_eta_C
from pyhees.section4_1 import calc_heating_load, calc_cooling_load, get_virtual_heating_devices, get_alpha_UT_H_A
from pyhees.section4_1_a import calc_heating_mode

import pyhees.section4_3 as rac
import pyhees.section4_3_a as rac_spec

def get_basic():
    """åŸºæœ¬æƒ…å ±ã®è¨­å®š

    :return: ä½å®…ã‚¿ã‚¤ãƒ—ã€ä½å®…å»ºã¦æ–¹ã€åºŠé¢ç©ã€åœ°åŸŸåŒºåˆ†ã€å¹´é–“æ—¥å°„åœ°åŸŸåŒºåˆ†
    """
    # ä½å®…ã‚¿ã‚¤ãƒ—
    type = 'ä¸€èˆ¬ä½å®…'

    # ä½å®…å»ºã¦æ–¹
    tatekata = 'æˆ¸å»ºä½å®…'

    # åºŠé¢ç©
    """
    A_A = 120.08
    A_MR = 29.81
    A_OR = 51.34
    """

    A_A = 132.84
    A_MR = 31.47
    A_OR = 64.18

    # åœ°åŸŸåŒºåˆ†
    region = 6

    # å¹´é–“æ—¥å°„åœ°åŸŸåŒºåˆ†
    sol_region = None

    return type, tatekata, A_A, A_MR, A_OR, region, sol_region

def get_env():
    """å¤–çš®ã®è¨­å®š

    :return: å¤–çš®æ¡ä»¶
    """
    """
    ENV = {
        'method': 'å½“è©²ä½å®…ã®å¤–çš®é¢ç©ã®åˆè¨ˆã‚’ç”¨ã„ã¦è©•ä¾¡ã™ã‚‹',
        'A_env': 307.51,
        'A_A': 120.08,
        'U_A': 0.87,
        'eta_A_H': 4.3,
        'eta_A_C': 2.8
    }
    """
    #ä¸‰é·¹Ié‚¸
    ENV = {
        'method': 'å½“è©²ä½å®…ã®å¤–çš®é¢ç©ã®åˆè¨ˆã‚’ç”¨ã„ã¦è©•ä¾¡ã™ã‚‹',
        'A_env': 362.04,
        'A_A': 132.84,
        'U_A': 0.377,
        'eta_A_H': 1.465,
        'eta_A_C': 0.796
    }

    #ä¸»ãŸã‚‹å±…å®¤:31.47m2ã€ãã®ä»–å±…å®¤:64.18m2ã€éå±…å®¤:37.19m2ã€åˆè¨ˆ:132.84m2


    # è‡ªç„¶é¢¨ã®åˆ©ç”¨ ä¸»ãŸã‚‹å±…å®¤
    NV_MR = 0
    # è‡ªç„¶é¢¨ã®åˆ©ç”¨ ãã®ä»–å±…å®¤
    NV_OR = 0

    # è“„ç†±
    TS = False

    # åºŠä¸‹ç©ºé–“ã‚’çµŒç”±ã—ã¦å¤–æ°—ã‚’å°å…¥ã™ã‚‹æ›æ°—æ–¹å¼ã®åˆ©ç”¨
    r_A_ufvnt = None

    # åºŠä¸‹ç©ºé–“ã®æ–­ç†±
    underfloor_insulation = None

    return ENV, NV_MR, NV_OR, TS, r_A_ufvnt, underfloor_insulation

def get_heating():
    """æš–æˆ¿ã®è¨­å®š

    :return: æš–æˆ¿æ–¹å¼ã€ä½æˆ¸å…¨ä½“ã®æš–æˆ¿æ¡ä»¶ã€ä¸»ãŸã‚‹å±…å®¤ã®æš–æˆ¿æ©Ÿå™¨ã€ãã®ä»–å±…å®¤ã®æš–æˆ¿æ©Ÿå™¨ã€æ¸©æ°´æš–æˆ¿ã®ç¨®é¡
    """
    # æš–æˆ¿æ–¹å¼
    mode_H = 'ä½æˆ¸å…¨ä½“ã‚’é€£ç¶šçš„ã«æš–æˆ¿ã™ã‚‹æ–¹å¼'

    # ä½æˆ¸å…¨ä½“ã‚’æš–æˆ¿ã™ã‚‹
    H_A = {
        'type': 'ãƒ€ã‚¯ãƒˆå¼ã‚»ãƒ³ãƒˆãƒ©ãƒ«ç©ºèª¿æ©Ÿ',
        'duct_insulation': 'å…¨ã¦ã‚‚ã—ãã¯ä¸€éƒ¨ãŒæ–­ç†±åŒºç”»å¤–ã§ã‚ã‚‹',
        'VAV': False,
        'general_ventilation': True,
        'EquipmentSpec': 'å…¥åŠ›ã—ãªã„'
    }

    # ä¸»ãŸã‚‹å±…å®¤æš–æˆ¿æ©Ÿå™¨
    H_MR = None

    # ãã®ä»–å±…å®¤æš–æˆ¿æ©Ÿå™¨
    H_OR = None

    # æ¸©æ°´æš–æˆ¿æ©Ÿã®ç¨®é¡
    H_HS = None

    return mode_H, H_A, H_MR, H_OR, H_HS

def get_cooling():
    """å†·æˆ¿ã®è¨­å®š

    :return: å†·æˆ¿æ–¹å¼ã€ä½æˆ¸å…¨ä½“ã®å†·æˆ¿æ¡ä»¶ã€ä¸»ãŸã‚‹å±…å®¤å†·æˆ¿æ¡ä»¶ã€ãã®ä»–å±…å®¤å†·æˆ¿æ¡ä»¶
    """
    # å†·æˆ¿æ–¹å¼
    mode_C = 'ä½æˆ¸å…¨ä½“ã‚’é€£ç¶šçš„ã«å†·æˆ¿ã™ã‚‹æ–¹å¼'

    # ä½æˆ¸å…¨ä½“ã‚’å†·æˆ¿ã™ã‚‹
    C_A = {
        'type': 'ãƒ€ã‚¯ãƒˆå¼ã‚»ãƒ³ãƒˆãƒ©ãƒ«ç©ºèª¿æ©Ÿ',
        'duct_insulation': 'å…¨ã¦ã‚‚ã—ãã¯ä¸€éƒ¨ãŒæ–­ç†±åŒºç”»å¤–ã§ã‚ã‚‹',
        'VAV': False,
        'general_ventilation': True,
        'EquipmentSpec': 'å…¥åŠ›ã—ãªã„'
    }

    # ä¸»ãŸã‚‹å±…å®¤å†·æˆ¿æ©Ÿå™¨
    C_MR = None

    # ãã®ä»–å±…å®¤å†·æˆ¿æ©Ÿå™¨
    C_OR = None

    return mode_C, C_A, C_MR, C_OR

def get_CRAC_spec():
    #A_HCZ = 120.08
    A_HCZ = 132.84
    #e_class = 'ã„'
    e_class = 'ã¯'

    # å®šæ ¼å†·æˆ¿èƒ½åŠ›, å®šæ ¼æš–æˆ¿èƒ½åŠ›
    #q_rtd_C = rac_spec.get_q_rtd_C(A_HCZ)
    q_rtd_C = 2800
    q_rtd_H = rac_spec.get_q_rtd_H(q_rtd_C)

    # æœ€å¤§å†·æˆ¿èƒ½åŠ›, æœ€å¤§æš–æˆ¿èƒ½åŠ›
    q_max_C = rac_spec.get_q_max_C(q_rtd_C)
    q_max_H = rac_spec.get_q_max_H(q_rtd_H, q_max_C)

    # å®šæ ¼å†·æˆ¿ã‚¨ãƒãƒ«ã‚®ãƒ¼åŠ¹ç‡
    e_rtd_C = rac_spec.get_e_rtd_C(e_class, q_rtd_C)
    e_rtd_H = rac_spec.get_e_rtd_H(e_rtd_C)

    return q_rtd_C, q_rtd_H, q_max_C, q_max_H, e_rtd_C, e_rtd_H

def get_heatexchangeventilation():
    """ç†±äº¤æ›å‹æ›æ°—ã®è¨­å®š

    :return: ç†±äº¤æ›å‹æ›æ°—
    """
    # ç†±äº¤æ›å‹æ›æ°—
    HEX = None

    return HEX

def get_solarheat():
    """å¤ªé™½ç†±åˆ©ç”¨ã®è¨­å®š

    :return: å¤ªé™½ç†±åˆ©ç”¨
    """
    # å¤ªé™½ç†±åˆ©ç”¨
    SHC = None

    return SHC

"""# åŸºæœ¬æ¡ä»¶ã®å–å¾—"""

# ---------- è¨ˆç®—æ¡ä»¶ã®å–å¾— ----------

# åŸºæœ¬æƒ…å ±ã‚’å–å¾—
type, tatekata, A_A, A_MR, A_OR, region, sol_region = get_basic()

# å¤–çš®æ¡ä»¶ã‚’å–å¾—
ENV, NV_MR, NV_OR, TS, r_A_ufvnt, underfloor_insulation = get_env()

# æš–æˆ¿æ¡ä»¶ã®å–å¾—
mode_H, H_A, H_MR, H_OR, H_HS = get_heating()

# å†·æˆ¿æ¡ä»¶ã®å–å¾—
mode_C, C_A, C_MR, C_OR = get_cooling()

# ç†±äº¤æ›å‹æ›æ°—ã®å–å¾—
HEX = get_heatexchangeventilation()

# å¤ªé™½ç†±åˆ©ç”¨ã®å–å¾—
SHC = get_solarheat()

# ã‚»ãƒ³ãƒˆãƒ©ãƒ«ãƒ«ãƒ¼ãƒ ã‚¨ã‚¢ã‚³ãƒ³ãƒ‡ã‚£ã‚·ãƒ§ãƒŠã®æ€§èƒ½ã®å–å¾—
q_rtd_C, q_rtd_H, q_max_C, q_max_H, e_rtd_C, e_rtd_H = get_CRAC_spec()

# ---------- ãã®ä»–è¨ˆç®—æ¡ä»¶ã‚’å–å¾— ----------

 # åºŠé¢ç©ã®åˆè¨ˆã«å¯¾ã™ã‚‹å¤–çš®ã®éƒ¨ä½ã®é¢ç©ã®åˆè¨ˆã®æ¯”
r_env = calc_r_env(
     method='å½“è©²ä½æˆ¸ã®å¤–çš®ã®éƒ¨ä½ã®é¢ç©ç­‰ã‚’ç”¨ã„ã¦å¤–çš®æ€§èƒ½ã‚’è©•ä¾¡ã™ã‚‹æ–¹æ³•',
    A_env=ENV['A_env'],
    A_A=A_A
 )

# ç†±æå¤±ä¿‚æ•°ï¼ˆæ›æ°—ã«ã‚ˆã‚‹ç†±æå¤±ã‚’å«ã¾ãªã„ï¼‰
Q_dash = get_Q_dash(ENV['U_A'], r_env)
# ç†±æå¤±ä¿‚æ•°
Q = get_Q(Q_dash)

# æ—¥å°„å–å¾—ä¿‚æ•°ã®å–å¾—
mu_H = get_eta_H(ENV['eta_A_H'], r_env)
mu_C = get_eta_C(ENV['eta_A_C'], r_env)

# å®Ÿè³ªçš„ãªæš–æˆ¿æ©Ÿå™¨ã®ä»•æ§˜ã‚’å–å¾—
spec_MR, spec_OR = get_virtual_heating_devices(region, H_MR, H_OR)

# æš–æˆ¿æ–¹å¼åŠã³é‹è»¢æ–¹æ³•ã®åŒºåˆ†
mode_MR, mode_OR = calc_heating_mode(region=region, H_MR=spec_MR, H_OR=spec_OR)

YUCACO = True

if YUCACO:
    CAV = True
    r_A_ufvnt = (8.28+16.56+21.53) / (9.52+1.24+3.31+3.31+1.66+8.28+16.56+21.53) 
    underfloor_insulation = True       #åºŠä¸‹æ–­ç†±ã‚ã‚Š
else:
    CAV = True
    r_A_ufvnt = None
    underfloor_insulation = False

#CAV= False

"""# æš–æˆ¿è² è·ã®å–å¾—ï¼ˆMJ/hï¼‰"""

# æš–æˆ¿è² è·ã®å–å¾—
print('ã€æš–æˆ¿è² è·ã®å–å¾—ã€‘')
print('\tçœã‚¨ãƒãƒ«ã‚®ãƒ¼åœ°åŸŸåŒºåˆ†\t\t\t\t\t\t\t\t\tregion = {}'.format(region))
print('\tå¹´é–“ã®æ—¥å°„åœ°åŸŸåŒºåˆ†(1-5)\t\t\t\t\t\t\t\t\tsol_region = {}'.format(sol_region))
print('\tåºŠé¢ç©ã®åˆè¨ˆ (m2)\t\t\t\t\t\t\t\t\tA_A = {}'.format(A_A))
print('\tä¸»ãŸã‚‹å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\t\t\t\tA_MR = {}'.format(A_MR))
print('\tãã®ä»–ã®å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\t\t\tA_OR = {}'.format(A_OR))
print('\tå½“è©²ä½æˆ¸ã®ç†±æå¤±ä¿‚æ•° (W/m2K)\t\t\t\t\t\t\t\tQ = {}'.format(Q))
print('\tå½“è©²ä½æˆ¸ã®æš–æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\t\t\tmu_H = {}'.format(mu_H))
print('\tå½“è©²ä½æˆ¸ã®å†·æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\t\t\tmu_C = {}'.format(mu_C))
print('\tä¸»ãŸã‚‹å±…å®¤ã«ãŠã‘ã‚‹é€šé¢¨ã®åˆ©ç”¨ã«ãŠã‘ã‚‹ç›¸å½“æ›æ°—å›æ•°\t\t\t\t\tNV_MR = {}'.format(NV_MR))
print('\tãã®ä»–ã®å±…å®¤ã«ãŠã‘ã‚‹é€šé¢¨ã®åˆ©ç”¨ã«ãŠã‘ã‚‹ç›¸å½“æ›æ°—å›æ•°\t\t\t\t\tNV_OR = {}'.format(NV_OR))
print('\tè“„ç†±ã®åˆ©ç”¨\t\t\t\t\t\t\t\t\t\tTS = {}'.format(TS))
print('\tå½“è©²ä½æˆ¸ã«ãŠã„ã¦ã€åºŠä¸‹ç©ºé–“å…¨ä½“ã®é¢ç©ã«å¯¾ã™ã‚‹ç©ºæ°—ã‚’ä¾›çµ¦ã™ã‚‹åºŠä¸‹ç©ºé–“ã®é¢ç©ã®æ¯” (-)\tr_A_ufvnt = {}'.format(r_A_ufvnt))
print('\tç†±äº¤æ›å™¨å‹è¨­å‚™ä»•æ§˜è¾æ›¸\t\t\t\t\t\t\t\t\tHEX = {}'.format(HEX))
print('\tåºŠä¸‹ç©ºé–“ãŒæ–­ç†±ç©ºé–“å†…ã§ã‚ã‚‹å ´åˆã¯True\t\t\t\t\t\t\tunderfloor_insulation = {}'.format(underfloor_insulation))
print('\tæš–æˆ¿æ–¹å¼\t\t\t\t\t\t\t\t\t\tmode_H = {}'.format(mode_H))
print('\tå†·æˆ¿æ–¹å¼\t\t\t\t\t\t\t\t\t\tmode_C = {}'.format(mode_C))
print('\tä¸»ãŸã‚‹å±…å®¤ã®æš–æˆ¿æ©Ÿå™¨ã®ä»•æ§˜\t\t\t\t\t\t\t\tspec_MR = {}'.format(spec_MR))
print('\tãã®ä»–ã®å±…å®¤ã®æš–æˆ¿æ©Ÿå™¨ã®ä»•æ§˜\t\t\t\t\t\t\t\tspec_OR = {}'.format(spec_OR))
print('\tä¸»ãŸã‚‹å±…å®¤ã®é‹è»¢æ–¹æ³• (é€£ç¶šé‹è»¢|é–“æ­‡é‹è»¢)\t\t\t\t\t\tmode_MR = {}'.format(mode_MR))
print('\tãã®ä»–ã®å±…å®¤ã®é‹è»¢æ–¹æ³• (é€£ç¶šé‹è»¢|é–“æ­‡é‹è»¢)\t\t\t\t\t\tmode_OR = {}'.format(mode_OR))

L_H_d_t_i, _ = calc_heating_load(region, sol_region, A_A, A_MR, A_OR, Q, mu_H, mu_C, NV_MR, NV_OR, TS, r_A_ufvnt,
                                     HEX, underfloor_insulation, mode_H, mode_C, spec_MR, spec_OR, mode_MR, mode_OR, SHC)

plt.rcParams["font.size"] = 10
fig  =plt.figure(facecolor = 'w', figsize = (15, 20))

for ix in range(len(L_H_d_t_i)):
    ax = fig.add_subplot(len(L_H_d_t_i), 1, ix + 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), L_H_d_t_i[ix], linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('æš–æˆ¿è² è·ã€€[MJ/h]')                                                                           
    ax.set_ylim(0, 10)

plt.show()

"""# å†·æˆ¿è² è·ã®å–å¾—ï¼ˆMJ/hï¼‰"""

# å†·æˆ¿è² è·ã®å–å¾—
print('ã€å†·æˆ¿è² è·ã®å–å¾—ã€‘')
print('\tçœã‚¨ãƒãƒ«ã‚®ãƒ¼åœ°åŸŸåŒºåˆ†\t\t\t\t\t\t\t\t\tregion = {}'.format(region))
print('\tåºŠé¢ç©ã®åˆè¨ˆ (m2)\t\t\t\t\t\t\t\t\tA_A = {}'.format(A_A))
print('\tä¸»ãŸã‚‹å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\t\t\t\tA_MR = {}'.format(A_MR))
print('\tãã®ä»–ã®å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\t\t\tA_OR = {}'.format(A_OR))
print('\tå½“è©²ä½æˆ¸ã®ç†±æå¤±ä¿‚æ•° (W/m2K)\t\t\t\t\t\t\t\tQ = {}'.format(Q))
print('\tå½“è©²ä½æˆ¸ã®æš–æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\t\t\tmu_H = {}'.format(mu_H))
print('\tå½“è©²ä½æˆ¸ã®å†·æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\t\t\tmu_C = {}'.format(mu_C))
print('\tä¸»ãŸã‚‹å±…å®¤ã«ãŠã‘ã‚‹é€šé¢¨ã®åˆ©ç”¨ã«ãŠã‘ã‚‹ç›¸å½“æ›æ°—å›æ•°\t\t\t\t\tNV_MR = {}'.format(NV_MR))
print('\tãã®ä»–ã®å±…å®¤ã«ãŠã‘ã‚‹é€šé¢¨ã®åˆ©ç”¨ã«ãŠã‘ã‚‹ç›¸å½“æ›æ°—å›æ•°\t\t\t\t\tNV_OR = {}'.format(NV_OR))
print('\tå½“è©²ä½æˆ¸ã«ãŠã„ã¦ã€åºŠä¸‹ç©ºé–“å…¨ä½“ã®é¢ç©ã«å¯¾ã™ã‚‹ç©ºæ°—ã‚’ä¾›çµ¦ã™ã‚‹åºŠä¸‹ç©ºé–“ã®é¢ç©ã®æ¯” (-)\tr_A_ufvnt = {}'.format(r_A_ufvnt))
print('\tåºŠä¸‹ç©ºé–“ãŒæ–­ç†±ç©ºé–“å†…ã§ã‚ã‚‹å ´åˆã¯True\t\t\t\t\t\t\tunderfloor_insulation = {}'.format(underfloor_insulation))
print('\tå†·æˆ¿æ–¹å¼\t\t\t\t\t\t\t\t\t\tmode_C = {}'.format(mode_C))
print('\tæš–æˆ¿æ–¹å¼\t\t\t\t\t\t\t\t\t\tmode_H = {}'.format(mode_H))
print('\tä¸»ãŸã‚‹å±…å®¤ã®é‹è»¢æ–¹æ³• (é€£ç¶šé‹è»¢|é–“æ­‡é‹è»¢)\t\t\t\t\t\tmode_MR = {}'.format(mode_MR))
print('\tãã®ä»–ã®å±…å®¤ã®é‹è»¢æ–¹æ³• (é€£ç¶šé‹è»¢|é–“æ­‡é‹è»¢)\t\t\t\t\t\tmode_OR = {}'.format(mode_OR))
print('\tè“„ç†±ã®åˆ©ç”¨\t\t\t\t\t\t\t\t\t\tTS = {}'.format(TS))
print('\tç†±äº¤æ›å™¨å‹è¨­å‚™ä»•æ§˜è¾æ›¸\t\t\t\t\t\t\t\t\tHEX = {}'.format(HEX))

L_CS_d_t_i, L_CL_d_t_i = calc_cooling_load(region, A_A, A_MR, A_OR, Q, mu_H, mu_C, NV_MR, NV_OR, r_A_ufvnt,
                                               underfloor_insulation, mode_C, mode_H, mode_MR, mode_OR, TS, HEX)

plt.rcParams["font.size"] = 10
fig  =plt.figure(facecolor = 'w', figsize = (15, 20))

for ix in range(len(L_H_d_t_i)):
    ax = fig.add_subplot(len(L_H_d_t_i), 1, ix + 1)                                   
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), L_CS_d_t_i[ix], linewidth = 0.5)
    ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), L_CL_d_t_i[ix], linewidth = 0.5)
    ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
    ax.set_ylabel('å†·æˆ¿è² è·ã€€[MJ/h]')                                                                           
    ax.set_ylim(0, 10)

plt.show()

"""# æš–æˆ¿æ¶ˆè²»é›»åŠ›ã®è¨ˆç®—ï¼ˆkWh/hï¼‰"""

print('ã€æš–æˆ¿æ¶ˆè²»é›»åŠ›ã®è¨ˆç®—ã€‘')
print('\tåºŠé¢ç©ã®åˆè¨ˆ (m2)\t\t\t\t\t\t\tA_A = {}'.format(A_A))
print('\tä¸»ãŸã‚‹å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\t\tA_MR = {}'.format(A_MR))
print('\tãã®ä»–ã®å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\tA_OR = {}'.format(A_OR))
print('\tå¤–çš®ã®éƒ¨ä½ã®é¢ç©ã®åˆè¨ˆ (m2)\t\t\t\t\tA_env = {}'.format(ENV['A_env']))
print('\tå½“è©²ä½æˆ¸ã®æš–æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\tmu_H = {}'.format(mu_H))
print('\tå½“è©²ä½æˆ¸ã®å†·æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\tmu_C = {}'.format(mu_C))
print('\tå½“è©²ä½æˆ¸ã®ç†±æå¤±ä¿‚æ•° (W/m2K)\t\t\t\t\t\tQ = {}'.format(Q))
print('\tæš–æˆ¿æ–¹å¼\t\t\t\t\t\t\t\tH_A = {}'.format(H_A))
print('\tæš–æˆ¿è² è·\t\t\t\t\t\t\t\tL_H_d_t_i')
print('\tå†·æˆ¿é¡•ç†±è² è·\t\t\t\t\t\t\t\tL_CS_d_t_i')
print('\tå†·æˆ¿æ½œç†±è² è·\t\t\t\t\t\t\t\tL_CL_d_t_i')
print('\tçœã‚¨ãƒãƒ«ã‚®ãƒ¼åœ°åŸŸåŒºåˆ†\t\t\t\t\t\t\tregion = {}'.format(region))
print('\tå®šæ ¼å†·æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_rtd_C = {}'.format(q_rtd_C))
print('\tå®šæ ¼æš–æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_rtd_H = {}'.format(q_rtd_H))
print('\tæœ€å¤§å†·æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_max_C = {}'.format(q_max_C))
print('\tæœ€å¤§æš–æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_max_H = {}'.format(q_max_H))
print('\tå®šæ ¼æš–æˆ¿ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»åŠ¹ç‡\t\t\t\t\t\tq_max_H = {}'.format(e_rtd_H))

V_fan_rtd_H = dc_spec.get_V_fan_rtd_H(q_rtd_H)
V_hs_dsgn_H = dc_spec.get_V_fan_dsgn_H(V_fan_rtd_H)
P_fan_rtd_H = dc_spec.get_P_fan_rtd_H(V_fan_rtd_H)

V_hs_dsgn_C = 0

print('\tå®šæ ¼æš–æˆ¿èƒ½åŠ›é‹è»¢æ™‚ã®é€é¢¨æ©Ÿã®é¢¨é‡(m3/h)\t\t\t\t\tV_fan_rtd_H = {}'.format(V_fan_rtd_H))
print('\tæš–æˆ¿æ™‚ã®é€é¢¨æ©Ÿã®è¨­è¨ˆé¢¨é‡(m3/h)\t\t\t\t\t\tV_hs_dsgn_H = {}'.format(V_hs_dsgn_H))
print('\tå®šæ ¼æš–æˆ¿èƒ½åŠ›é‹è»¢æ™‚ã®é€é¢¨æ©Ÿã®æ¶ˆè²»é›»åŠ›(W)\t\t\t\t\tP_fan_rtd_H = {}'.format(P_fan_rtd_H))

_, Q_UT_H_d_t_i, _, _, Theta_hs_out_d_t, Theta_hs_in_d_t, _, _, V_hs_supply_d_t, V_hs_vent_d_t, C_df_H_d_t\
 = calc_CRAC_Q_UT_A(A_A, A_MR, A_OR, ENV['A_env'], mu_H, mu_C,
                    q_rtd_C, q_rtd_H, q_max_C, q_max_H, V_hs_dsgn_H, V_hs_dsgn_C, Q, H_A['VAV'], H_A['general_ventilation'],
                    H_A['duct_insulation'], region, L_H_d_t_i, L_CS_d_t_i, L_CL_d_t_i)

E_E_H_d_t = calc_CRAC_E_E_H_d_t(Theta_hs_out_d_t = Theta_hs_out_d_t,
                                Theta_hs_in_d_t = Theta_hs_in_d_t,
                                V_hs_supply_d_t = V_hs_supply_d_t,
                                V_hs_vent_d_t = V_hs_vent_d_t,
                                C_df_H_d_t = C_df_H_d_t,
                                V_hs_dsgn_H = V_hs_dsgn_H,
                                P_fan_rtd_H = P_fan_rtd_H,
                                region = region,
                                q_rtd_C = q_rtd_C,
                                q_rtd_H = q_rtd_H,
                                e_rtd_H = e_rtd_H)

alpha_UT_H_A = get_alpha_UT_H_A(region)
Q_UT_H_A_d_t = np.sum(Q_UT_H_d_t_i, axis=0)
E_UT_H_d_t = Q_UT_H_A_d_t * alpha_UT_H_A

print('ã€æš–æˆ¿æ¶ˆè²»é›»åŠ›ã®è¨ˆç®—çµæœã€‘')
fig=plt.figure(facecolor = 'w', figsize = (15, 2))
ax = fig.add_subplot(1, 1, 1)                                   
ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_E_H_d_t, linewidth = 0.5)
ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
ax.set_ylabel('æš–æˆ¿æ¶ˆè²»é›»åŠ›ã€€[kWh/h]')                                                                           
ax.set_ylim(0, 5)
plt.show() 

print('ã€æš–æˆ¿æœªå‡¦ç†è² è·ã®è¨ˆç®—çµæœã€‘')
fig=plt.figure(facecolor = 'w',figsize = (15, 2))
ax = fig.add_subplot(1, 1, 1)                                   
ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_UT_H_d_t, linewidth = 0.5)
ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
ax.set_ylabel('æš–æˆ¿æœªå‡¦ç†è² è·(ä¸€æ¬¡ã‚¨ãƒ) [MJ/h]')                                                                           
ax.set_ylim(0, 10)
plt.show()

"""# å†·æˆ¿æ¶ˆè²»é›»åŠ›ã®è¨ˆç®—ï¼ˆkWh/hï¼‰"""

print('\tçœã‚¨ãƒãƒ«ã‚®ãƒ¼åœ°åŸŸåŒºåˆ†\t\t\t\t\t\t\tregion = {}'.format(region))
print('\tåºŠé¢ç©ã®åˆè¨ˆ (m2)\t\t\t\t\t\t\tA_A = {}'.format(A_A))
print('\tä¸»ãŸã‚‹å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\t\tA_MR = {}'.format(A_MR))
print('\tãã®ä»–ã®å±…å®¤ã®åºŠé¢ç© (m2)\t\t\t\t\t\tA_OR = {}'.format(A_OR))
print('\tA_env: å¤–çš®ã®éƒ¨ä½ã®é¢ç©ã®åˆè¨ˆ (m2)\t\t\t\t\tA_env = {}'.format(ENV['A_env']))
print('\tå½“è©²ä½æˆ¸ã®æš–æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\tmu_H = {}'.format(mu_H))
print('\tå½“è©²ä½æˆ¸ã®å†·æˆ¿æœŸã®æ—¥å°„å–å¾—ä¿‚æ•° ((W/m2)/(W/m2))\t\t\t\tmu_C = {}'.format(mu_C))
print('\tå½“è©²ä½æˆ¸ã®ç†±æå¤±ä¿‚æ•° (W/m2K)\t\t\t\t\t\tQ = {}'.format(Q))
print('\tå†·æˆ¿æ–¹å¼\t\t\t\t\t\t\t\tC_A = {}'.format(C_A))
print('\tä¸»ãŸã‚‹å±…å®¤ã®å†·æˆ¿æ©Ÿå™¨\t\t\t\t\t\t\tC_MR = {}'.format(C_MR))
print('\tãã®ä»–ã®å±…å®¤ã®å†·æˆ¿æ©Ÿå™¨\t\t\t\t\t\t\tC_OR = {}'.format(C_OR))
print('\tæš–æˆ¿è² è·\t\t\t\t\t\t\t\tL_H_d_t_i')
print('\tå†·æˆ¿é¡•ç†±è² è·\t\t\t\t\t\t\t\tL_CS_d_t_i')
print('\tå†·æˆ¿æ½œç†±è² è·\t\t\t\t\t\t\t\tL_CL_d_t_i')
print('\tå®šæ ¼å†·æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_rtd_C = {}'.format(q_rtd_C))
print('\tå®šæ ¼æš–æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_rtd_H = {}'.format(q_rtd_H))
print('\tæœ€å¤§å†·æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_max_C = {}'.format(q_max_C))
print('\tæœ€å¤§æš–æˆ¿èƒ½åŠ› (W)\t\t\t\t\t\t\tq_max_H = {}'.format(q_max_H))
print('\tå®šæ ¼æš–æˆ¿ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»åŠ¹ç‡\t\t\t\t\t\tq_max_H = {}'.format(e_rtd_H))

V_fan_rtd_C = dc_spec.get_V_fan_rtd_C(q_rtd_C)
V_hs_dsgn_C = dc_spec.get_V_fan_dsgn_C(V_fan_rtd_C)
P_fan_rtd_C = dc_spec.get_P_fan_rtd_C(V_fan_rtd_C)

V_hs_dsgn_H = 0

print('\tå®šæ ¼å†·æˆ¿èƒ½åŠ›é‹è»¢æ™‚ã®é€é¢¨æ©Ÿã®é¢¨é‡(m3/h)\t\t\t\t\tV_fan_rtd_C = {}'.format(V_fan_rtd_C))
print('\tå†·æˆ¿æ™‚ã®é€é¢¨æ©Ÿã®è¨­è¨ˆé¢¨é‡(m3/h)\t\t\t\t\t\tV_hs_dsgn_C = {}'.format(V_hs_dsgn_C))
print('\tå®šæ ¼å†·æˆ¿èƒ½åŠ›é‹è»¢æ™‚ã®é€é¢¨æ©Ÿã®æ¶ˆè²»é›»åŠ›(W)\t\t\t\t\tP_fan_rtd_C = {}'.format(P_fan_rtd_C))

E_UT_C_d_t, _, _, _, Theta_hs_out_d_t, Theta_hs_in_d_t, X_hs_out_d_t, X_hs_in_d_t, V_hs_supply_d_t, V_hs_vent_d_t, _\
= calc_CRAC_Q_UT_A(A_A, A_MR, A_OR, ENV['A_env'], mu_H, mu_C, 
                   q_rtd_C, q_rtd_H, q_max_C, q_max_H, V_hs_dsgn_H, V_hs_dsgn_C, Q, C_A['VAV'], C_A['general_ventilation'],
                   C_A['duct_insulation'], region, L_H_d_t_i, L_CS_d_t_i, L_CL_d_t_i)

E_E_C_d_t = get_CRAC_E_E_C_d_t(Theta_hs_out_d_t = Theta_hs_out_d_t,
                                 Theta_hs_in_d_t = Theta_hs_in_d_t,
                                 X_hs_out_d_t = X_hs_out_d_t,
                                 X_hs_in_d_t = X_hs_in_d_t,
                                 V_hs_supply_d_t = V_hs_supply_d_t,
                                 V_hs_vent_d_t = V_hs_vent_d_t,
                                 q_rtd_C = q_rtd_C,
                                 e_rtd_C = e_rtd_C,
                                 V_hs_dsgn_C = V_hs_dsgn_C,
                                 P_fan_rtd_C = P_fan_rtd_C,
                                 region = region)

print('ã€å†·æˆ¿æ¶ˆè²»é›»åŠ›ã®è¨ˆç®—çµæœã€‘')
fig=plt.figure(facecolor = 'w',figsize = (15, 2))
ax = fig.add_subplot(1, 1, 1)                                   
ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_E_C_d_t, linewidth = 0.5)
ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
ax.set_ylabel('å†·æˆ¿æ¶ˆè²»é›»åŠ›ã€€[kWh/h]')                                                                           
ax.set_ylim(0, 5)
plt.show() 

print('ã€å†·æˆ¿æœªå‡¦ç†è² è·ã®è¨ˆç®—çµæœã€‘')
fig=plt.figure(facecolor = 'w',figsize = (15, 2))
ax = fig.add_subplot(1, 1, 1)                                   
ax.plot(pd.date_range('2019-01-01 01:00:00', '2020-01-01 00:00:00', freq='h'), E_UT_C_d_t, linewidth = 0.5)
ax.xaxis.set_major_formatter(mdates.DateFormatter('%m/%d'))
ax.set_ylabel('å†·æˆ¿æœªå‡¦ç†è² è·(ä¸€æ¬¡ã‚¨ãƒ) [MJ/h]')                                                                           
ax.set_ylim(0, 10)
plt.show()

"""# è¨ˆç®—çµæœã®ã¾ã¨ã‚"""

# é›»æ°—ã®é‡ 1kWh ã‚’ç†±é‡ã«æ›ç®—ã™ã‚‹ä¿‚æ•°
f_prim = get_f_prim()

# 1 æ™‚é–“å½“ãŸã‚Šã®æš–æˆ¿è¨­å‚™ã®è¨­è¨ˆä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡ï¼ˆMJ/hï¼‰
E_H_d_t = E_E_H_d_t * f_prim / 1000 + E_UT_H_d_t

# 1 æ™‚é–“å½“ãŸã‚Šã®å†·æˆ¿è¨­å‚™ã®è¨­è¨ˆä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡ï¼ˆMJ/hï¼‰
E_C_d_t = E_E_C_d_t * f_prim / 1000 + E_UT_C_d_t

# 1 å¹´å½“ãŸã‚Šã®æš–æˆ¿è¨­å‚™ã®è¨­è¨ˆä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡ï¼ˆMJ/å¹´ï¼‰
E_H = np.sum(E_H_d_t)

# 1 å¹´å½“ãŸã‚Šã®å†·æˆ¿è¨­å‚™ã®è¨­è¨ˆä¸€æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¶ˆè²»é‡ï¼ˆMJ/å¹´ï¼‰
E_C = np.sum(E_C_d_t)

print({'E_H': E_H, 'E_C': E_C})

"""{'E_H': 38986.65275929407, 'E_C': 14596.270280805114}"""